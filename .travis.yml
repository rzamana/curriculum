sudo: required
services:
  - docker
language: php
php:
  - 7.0
before_install:
  - pip install --user awscli
  - export PATH=$PATH:$HOME/.local/bin
install:
  - composer update
script:
  - composer run full-test
after_success:
  - $(aws ecr get-login --no-include-email)
  - docker build -t rzamana/curriculum .
  - docker tag rzamana/curriculum $DOCKER_ECR_REPO:$TRAVIS_BUILD
  - docker push $DOCKER_ECR_REPO:$TRAVIS_BUILD
  - docker tag rzamana/curriculum $DOCKER_ECR_REPO:latest
  - docker push $DOCKER_ECR_REPO:latest
